import configparser
import logging

logging.basicConfig(filename="Logs.log", level=logging.INFO)
Log_file = logging.getLogger()

Cities = {
    "Івано-Франківськ": 1,
    "Ізмаїл": 2,
    "Ірпінь": 3,
    "Біла Церква": 4,
    "Бердянськ": 5,
    "Вінниця": 6,
    "Глухів": 7,
    "Дніпро": 8,
    "Донецьк": 9,
    "Дрогобич": 10,
    "Житомир": 11,
    "Жовті Води": 12,
    "Волинь": 13,
    "Запоріжжя": 14,
    "Кам'янець-Подільський": 15,
    "Кам'янське": 16,
    "Київ": 17,
    "Краматорськ": 18,
    "Кременець": 19,
    "Кременчук": 20,
    "Кривий Ріг": 21,
    "Кропивницький": 22,
    "Лисичанськ": 23,
    "Луганськ": 24,
    "Луцк": 25,
    "Львів": 26,
    "Маріуполь": 27,
    "Мелітополь": 28,
    "Миколаїв": 29,
    "Мукачево": 30,
    "Ніжин": 31,
    "Одеса": 32,
    "Острог": 33,
    "Переяслав": 34,
    "Полтава": 35,
    "Рівне": 36,
    "Слов'янськ": 37,
    "Суми": 38,
    "Тернопіль": 39,
    "Ужгород": 40,
    "Умань": 41,
    "Харків": 42,
    "Херсон": 43,
    "Хмельницький": 44,
    "Черкаси": 45,
    "Чернівці": 46,
    "Чернігів": 47,
    "Берегове": 48,
    "Сімферополь": 49
}

University = {
    "Європейський університет": 1,
    "Івано-франківський національний медичний університет": 2,
    "Івано-Франківський національний технічний університет нафти і газу": 3,
    "Івано-Франківський університет права імені Короля Данила Галицького": 4,
    "Ізмаїльський державний гуманітарний університет": 5,
    "Інститут підприємництва Стратегія": 6,
    "Академія адвокатури України": 7,
    "Академія муніципального управління": 8,
    "Академія праці. соціальних відносин і туризму": 9,
    "Білоцерківський національний аграрний університет": 10,
    "Бердянський державний педагогічний університет": 11,
    "Бердянський університет менеджменту і бізнесу": 12,
    "Буковинський державний медичний університет": 13,
    "Буковинський державний фінансово-економічний університет": 14,
    "Відкритий міжнародний університет розвитку людини «Україна»": 15,
    "Вінницький державний педагогічний університет імені Михайла Коцюбинського": 16,
    "Вінницький національний аграрний університет": 17,
    "Вінницький національний медичний університет ім. М.І. Пирогова": 18,
    "Вінницький національний технічний університет": 19,
    "Глухівський національний педагогічний університет імені Олександра Довженка": 20,
    "Державний економіко-технологічний університет транспорту": 21,
    "Державний університет інфраструктури та технологій": 22,
    "Державний університет телекомунікацій": 23,
    "Дніпровський гуманітарний університет": 24,
    "Дніпровський медичний інститут традиційної і нетрадиційної медицини": 25,
    "Дніпродзержинський державний технічний університет": 26,
    "Дніпропетровська медична академія": 27,
    "Дніпропетровський гуманітарний університет": 28,
    "Дніпропетровський державний інститут фізичної культури і спорту": 29,
    "Дніпропетровський державний аграрно-економічний університет": 30,
    "Дніпропетровський державний університет внутрішніх справ": 31,
    "Дніпропетровський національний університет": 32,
    "Дніпропетровський національний університет залізничного транспорту імені академіка В. Лазаряна": 33,
    "Дніпропетровський університет імені Альфреда Нобеля": 34,
    "Донбаська державна машинобудівна академія": 35,
    "Донбаська національна академія будівництва і архітектури": 36,
    "Донбаський державний педагогічний університет": 37,
    "Донбаський державний технічний університет": 38,
    "Донецький державний університет управління": 39,
    "Донецький національний медичний університет ім. М. Горького": 40,
    "Донецький національний технічний університет": 41,
    "Донецький національний університет": 42,
    "Донецький національний університет економіки і торгівлі імені Михайла Туган-Барановського": 43,
    "Донецький юридичний інститут": 44,
    "Дрогобицький державний педагогічний університет імені Івана Франка": 45,
    "Житомирський державний технологічний університет": 46,
    "Житомирський державний університет імені Івана Франка": 47,
    "Житомирський національний агроекологічний університет": 48,
    "Закарпатська академія мистецтв": 49,
    "Закарпатський угорський інститут імені Ференца Ракоці ІІ": 50,
    "Запорізька державна інженерна академія": 51,
    "Запорізький інститут економіки та інформаційних технологій": 52,
    "Запорізький державний медичний університет": 53,
    "Запорізький національний технічний університет": 54,
    "Запорізький національний університет": 55,
    "Кіровоградський державний педагогічний університет імені Володимира Винниченка": 56,
    "Кіровоградський національний технічний університет": 57,
    "Кам'янець-Подільський національний університет": 58,
    "Київська державна академія водного транспорту імені гетьмана Петра Конашевича-Сагайдачного": 59,
    "Київська державна академія декоративно-прикладного мистецтва і дизайну імені Михайла Бойчука": 60,
    "Київський державний інститут декоративно-прикладного мистецтва і дизайну імені Михайла Бойчука": 61,
    "Київський міжнародний університет": 62,
    "Київський медичний університет УАНМ": 63,
    "Київський національний економічний університет імені Вадима Гетьмана": 64,
    "Київський національний лінгвістичний університет": 65,
    "Київський національний торговельно-економічний університет": 66,
    "Київський національний університет імені Тараса Шевченка": 67,
    "Київський національний університет будівництва і архітектури": 68,
    "Київський національний університет культури і мистецтв": 69,
    "Київський національний університет театру. кіно і телебачення імені І.К. Карпенка-Карого": 70,
    "Київський національний університет технологій та дизайну": 71,
    "Київський університет імені Бориса Грінченка": 72,
    "Київський університет права Національної академії наук України": 73,
    "Київський університет туризму. економіки і права": 74,
    "Класичний приватний університет": 75,
    "Кременецька обласна гуманітарно-педагогічна академія ім. Тараса Шевченка": 76,
    "Кременчуцький національний університет імені Михайла Остроградського": 77,
    "Криворізький державний педагогічний університет": 78,
    "Криворізький національний університет": 79,
    "Луганський державний медичний університет": 80,
    "Луганський національний аграрний університет": 81,
    "Луганський національний університет імені Тараса Шевченка": 82,
    "Луцький національний технічний університет": 83,
    "Львівська національна академія мистецтв": 84,
    "Львівська національна музична академія імені М.В. Лисенка": 85,
    "Львівський інститут економіки і туризму": 86,
    "Львівський державний університет безпеки життєдіяльності": 87,
    "Львівський державний університет фізичної культури": 88,
    "Львівський національний аграрний університет": 89,
    "Львівський національний медичний університет імені Данила Галицького": 90,
    "Львівський національний університет імені Івана Франка": 91,
    "Львівський національний університет ветеринарної медицини та біотехнологій імені С.З. Гжицького": 92,
    "Львівський торговельно-економічний університет": 93,
    "Міжнародний економіко-гуманітарний університет": 94,
    "Міжнародний науково-технічний університет": 95,
    "Міжнародний університет фінансів": 96,
    "Міжрегіональна Академія управління персоналом": 97,
    "Маріупольський державний університет": 98,
    "Мелітопольський державний педагогічний університет імені Богдана Хмельницького": 99,
    "Миколаївський національний аграрний університет": 100,
    "Миколаївський національний університет імені В.О. Сухомлинського": 101,
    "Мукачівський державний університет": 102,
    "Ніжинський державний університет імені Миколи Гоголя": 103,
    "Національна академія внутрішніх справ": 104,
    "Національна академія керівних кадрів культури і мистецтв": 105,
    "Національна академія образотворчого мистецтва і архітектури": 106,
    "Національна академія статистики. обліку та аудиту": 107,
    "Національна академія управління": 108,
    "Національна металургійна академія України": 109,
    "Національна музична академія України імені П.І. Чайковського": 110,
    "Національний авіаційний університет": 111,
    "Національний аерокосмічний університет ім. М.Є. Жуковського Харківський авіаційний інститут": 112,
    "Національний гірничий університет": 113,
    "Національний лісотехнічний університет України": 114,
    "Національний медичний університет імені О.О. Богомольця": 115,
    "Національний педагогічний університет імені М.П. Драгоманова": 116,
    "Національний технічний університет України Київський політехнічний інститут": 117,
    "Національний технічний університет Харківський політехнічний інститут": 118,
    "Національний транспортний університет": 119,
    "Національний університет біоресурсів і природокористування України": 120,
    "Національний університет водного господарства та природокористування": 121,
    "Національний університет Києво-Могилянська академія": 122,
    "Національний університет кораблебудування імені адмірала Макарова": 123,
    "Національний університет Львівська політехніка": 124,
    "Національний університет Одеська морська академія": 125,
    "Національний університет Одеська юридична академія": 126,
    "Національний університет Острозька академія": 127,
    "Національний університет фізичного виховання і спорту України (НУФВСУ)": 128,
    "Національний університет харчових технологій": 129,
    "Національний університет цивільного захисту України": 130,
    "Національний фармацевтичний університет": 131,
    "Національний юридичний університет імені Ярослава Мудрого": 132,
    "Одеська державна академія будівництва та архітектури": 133,
    "Одеська державна академія технічного регулювання та якості": 134,
    "Одеська національна академія зв'язку ім. О.С. Попова": 135,
    "Одеська національна академія харчових технологій": 136,
    "Одеська національна музична академія ім. А.В. Нежданової": 137,
    "Одеський державний аграрний університет": 138,
    "Одеський державний екологічний університет": 139,
    "Одеський державний університет внутрішніх справ": 140,
    "Одеський національний економічний університет": 141,
    "Одеський національний медичний університет": 142,
    "Одеський національний морський університет": 143,
    "Одеський національний політехнічний університет": 144,
    "Одеський національний університет імені І.І. Мечникова": 145,
    "Південноукраїнський національний педагогічний університет імені К.Д. Ушинського": 146,
    "Переяслав-Хмельницький державний педагогічний університет імені Григорія Сковороди": 147,
    "Подільський державний аграрно-технічний університет": 148,
    "Полтавська державна аграрна академія": 149,
    "Полтавський національний педагогічний університет імені В.Г. Короленка": 150,
    "Полтавський національний технічний університет імені Юрія Кондратюка": 151,
    "Полтавський університет економіки і торгівлі": 152,
    "Приазовський державний технічний університет": 153,
    "Придніпровська державна академія будівництва та архітектури": 154,
    "Придніпровська державна академія фізичної культури і спорту": 155,
    "Прикарпатський національний університет імені Василя Стефаника": 156,
    "Рівненський державний гуманітарний університет": 157,
    "Сумський державний педагогічний університет ім. А.С. Макаренка": 158,
    "Сумський державний університет": 159,
    "Сумський національний аграрний університет": 160,
    "Східноєвропейський національний університет імені Лесі Українки": 161,
    "Східноукраїнський національний університет імені Володимира Даля": 162,
    "Таврійський державний агротехнологічний університет": 163,
    "Таврійський національний університет ім. В.І. Вернадського": 164,
    "Тернопільський державний медичний університет імені І.Я. Горбачевського": 165,
    "Тернопільський національний економічний університет": 166,
    "Тернопільський національний педагогічний університет імені Володимира Гнатюка": 167,
    "Тернопільський національний технічний університет імені Івана Пулюя": 168,
    "Ужгородський національний університет": 169,
    "Українська інженерно-педагогічна академія": 170,
    "Українська академія банківської справи Національного банку України": 171,
    "Українська академія друкарства": 172,
    "Українська медична стоматологічна академія": 173,
    "Український державний університет залізничного транспорту": 174,
    "Український державний хіміко-технологічний університет": 175,
    "Український Католицький Університет": 176,
    "Уманський державний педагогічний університет імені Павла Тичини": 177,
    "Уманський національний університет садівництва": 178,
    "Університет банківської справи НБУ": 179,
    "Університет державної фіскальної служби України": 180,
    "Університет економіки та права КРОК": 181,
    "Університет Короля Данила": 182,
    "Університет митної справи та фінансів": 183,
    "Університет сучасних знань": 184,
    "Харківська гуманітарно-педагогічна академія": 185,
    "Харківська державна академія дизайну і мистецтв": 186,
    "Харківська державна академія культури": 187,
    "Харківська державна академія фізичної культури": 188,
    "Харківська державна зооветеринарна академія": 189,
    "Харківський гуманітарний університет Народна українська академія": 190,
    "Харківський державний університет харчування та торгівлі": 191,
    "Харківський національний автомобільно-дорожній університет": 192,
    "Харківський національний аграрний університет ім. В.В. Докучаєва": 193,
    "Харківський національний економічний університет імені Семена Кузнеця": 194,
    "Харківський національний медичний університет": 195,
    "Харківський національний педагогічний університет імені Г.С. Сковороди": 196,
    "Харківський національний технічний університет сільського господарства імені Петра Василенка": 197,
    "Харківський національний університет імені В.Н. Каразіна": 198,
    "Харківський національний університет будівництва та архітектури": 199,
    "Харківський національний університет внутрішніх справ": 200,
    "Харківський національний університет міського господарства імені О.М. Бекетова": 201,
    "Харківський національний університет мистецтв ім. І.П. Котляревського": 202,
    "Харківський національний університет Повітряних Сил імені Івана Кожедуба": 203,
    "Харківський національний університет радіоелектроніки": 204,
    "Херсонська державна морська академія": 205,
    "Херсонський державний аграрний університет": 206,
    "Херсонський державний університет": 207,
    "Херсонський національний технічний університет": 208,
    "Хмельницька гуманітарно-педагогічна академія": 209,
    "Хмельницький національний університет": 210,
    "Хмельницький університет управління та права": 211,
    "Черкаський державний технологічний університет": 212,
    "Черкаський національний університет імені Богдана Хмельницького": 213,
    "Чернівецький національний університет імені Юрія Федьковича": 214,
    "Чернігівський національний педагогічний університет імені Т.Г. Шевченка": 215,
    "Чернігівський національний технологічний університет": 216,
    "Чорноморський державний університет імені Петра Могили": 217
}

Specializations = {
    "Інженерія програмного забезпечення": 1,
    "Інформаційна, бібліотечна та архівна справа": 2,
    "Історія та археологія": 3,
    "Авіаційна та ракетно-космічна техніка": 4,
    "Авіаційний транспорт": 5,
    "Авіоніка": 6,
    "Автоматизація та комп’ютерно-інтегровані технології": 7,
    "Автомобільний транспорт": 8,
    "Агроінженерія": 9,
    "Агрономія": 10,
    "Архітектура та містобудування": 11,
    "Атомна енергетика": 12,
    "Аудіовізуальне мистецтво та виробництво": 13,
    "Біологія": 14,
    "Біомедична інженерія": 15,
    "Біотехнології та біоінженерія": 16,
    "Безпека державного кордону": 17,
    "Богослов’я": 18,
    "Будівництво та цивільна інженерія": 19,
    "Військове управління (за видами збройних сил)": 20,
    "Ветеринарна гігієна, санітарія і експертиза": 21,
    "Ветеринарна медицина": 22,
    "Видавництво та поліграфія": 23,
    "Водні біоресурси та аквакультура": 24,
    "Гідроенергетика": 25,
    "Гірництво": 26,
    "Галузеве машинобудування": 27,
    "Геодезія та землеустрій": 28,
    "Готельно-ресторанна справа": 29,
    "Державна безпека": 30,
    "Дизайн": 31,
    "Дошкільна освіта": 32,
    "Екологія": 33,
    "Економіка": 34,
    "Електроенергетика, електротехніка та електромеханіка": 35,
    "Електроніка": 36,
    "Енергетичне машинобудування": 37,
    "Журналістика": 38,
    "Забезпечення військ (сил)": 39,
    "Залізничний транспорт": 40,
    "Захист і карантин рослин": 41,
    "Кібербезпека": 42,
    "Комп’ютерні науки та інформаційні технології": 43,
    "Комп’ютерна інженерія": 44,
    "Культурологія": 45,
    "Лісове господарство": 46,
    "Міжнародні відносини, суспільні комунікації та регіональні студії": 47,
    "Міжнародні економічні відносини": 48,
    "Міжнародне право": 49,
    "Мікро- та наносистемна техніка": 50,
    "Маркетинг": 51,
    "Математика": 52,
    "Матеріалознавство": 53,
    "Медицина": 54,
    "Медична та психологічна реабілітація": 55,
    "Медсестринство": 56,
    "Менеджмент": 57,
    "Менеджмент соціокультурної діяльності": 58,
    "Металургія": 59,
    "Метрологія та інформаційно-вимірювальна техніка": 60,
    "Музеєзнавство, пам’яткознавство": 61,
    "Музичне мистецтво": 62,
    "Науки про Землю": 63,
    "Науки про освіту": 64,
    "Нафтогазова інженерія та технології": 65,
    "Начальное образование": 66,
    "Облік і оподаткування": 67,
    "Образотворче мистецтво, декоративне мистецтво, реставрація": 68,
    "Озброєння та військова техніка": 69,
    "Підприємництво, торгівля та біржова діяльність": 70,
    "Пожежна безпека": 71,
    "Політологія": 72,
    "Початкова освіта": 73,
    "Право": 74,
    "Правоохоронна діяльність": 75,
    "Прикладна математика": 76,
    "Прикладна механіка": 77,
    "Прикладна фізика та наноматеріали": 78,
    "Професійна освіта (за спеціалізаціями)": 79,
    "Психологія": 80,
    "Публічне управління та адміністрування": 81,
    "Річковий та морський транспорт": 82,
    "Релігієзнавство": 83,
    "Садівництво та виноградарство": 84,
    "Садово-паркове господарство": 85,
    "Середня освіта (за предметними спеціалізаціями)": 86,
    "Системний аналіз": 87,
    "Соціальна робота": 88,
    "Соціальне забезпечення": 89,
    "Соціологія": 90,
    "Спеціальна освіта": 91,
    "Статистика": 92,
    "Стоматологія": 93,
    "Суднобудування": 94,
    "Сценічне мистецтво": 95,
    "Телекомунікації та радіотехніка": 96,
    "Теплоенергетика": 97,
    "Технології захисту навколишнього середовища": 98,
    "Технології легкої промисловості": 99,
    "Технології медичної діагностики та лікування": 100,
    "Технологія виробництва і переробки продукції тваринництва": 101,
    "Транспортні технології (за видами)": 102,
    "Туризм": 103,
    "Фізика та астрономія": 104,
    "Фізична культура і спорт": 105,
    "Фізична реабілітація": 106,
    "Філологія": 107,
    "Філософія": 108,
    "Фінанси, банківська справа та страхування": 109,
    "Фармація": 110,
    "Хімічні технології та інженерія": 111,
    "Хімія": 112,
    "Харчові технології": 113,
    "Хореографія": 114,
    "Цивільна безпека": 115
}

config = configparser.ConfigParser()
config.read('PricePredictor.API/Settings/settings.ini')

Sql_query = """
    SELECT c.Name as CityName,
           u.Name as UniversityName,
           r1.Position,
           r1.Value as INP,
           r2.Value as 'IN',
           r3.Value as INV,
           r4.Value as Iz,
           usd.Value as USD,
           eur.Value as EUR,
           y.Year,
           syu.EducationType,
           syu.Specialization,
           syu.Price
    FROM University AS u
             LEFT JOIN Cities AS c ON u.CityGUID = c.GUID
             LEFT JOIN (SELECT UniversityGUID, Position, Value, YearGUID
                        FROM RatingToYearUniversity
                        WHERE RatingGUID = 'cc548760-7d4c-11ec-acd1-3cf011acbb24') AS r1 ON r1.UniversityGUID = u.GUID
             LEFT JOIN (SELECT GUID, Year
                        FROM Years) AS y ON r1.YearGUID = y.GUID
             LEFT JOIN (SELECT UniversityGUID, Value, YearGUID
                        FROM RatingToYearUniversity
                        WHERE RatingGUID = 'd06376dd-7d4c-11ec-acd1-3cf011acbb24') AS r2
                        ON r2.UniversityGUID = r1.UniversityGUID and r2.YearGUID = r1.YearGUID
             LEFT JOIN (SELECT UniversityGUID, Value, YearGUID
                        FROM RatingToYearUniversity
                        WHERE RatingGUID = 'd3269e1f-7d4c-11ec-acd1-3cf011acbb24') AS r3
                        ON r3.UniversityGUID = r2.UniversityGUID and r3.YearGUID = r2.YearGUID
             LEFT JOIN (SELECT UniversityGUID, Value, YearGUID
                        FROM RatingToYearUniversity
                        WHERE RatingGUID = 'd616ebe6-7d4c-11ec-acd1-3cf011acbb24') AS r4
                        ON r4.UniversityGUID = r3.UniversityGUID and r4.YearGUID = r3.YearGUID
             LEFT JOIN (SELECT YearGUID, Value FROM ExchangeRates WHERE Currency = 'USD') AS usd
                        ON y.GUID = usd.YearGUID
             LEFT JOIN (SELECT YearGUID, Value FROM ExchangeRates WHERE Currency = 'EUR') AS eur
                        ON y.GUID = eur.YearGUID
             LEFT JOIN (SELECT YearGUID, s.Name as Specialization, UniversityGUID, Price, EducationType
                        FROM SpecializationsToYearToUniversity as sy
                        LEFT JOIN Specializations s on sy.SpecializationsGUID = s.GUID) AS syu ON y.GUID = syu.YearGUID 
                        AND r1.UniversityGUID = syu.UniversityGUID
    ORDER BY r1.Position, y.Year;
"""
